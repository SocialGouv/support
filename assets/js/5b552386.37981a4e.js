"use strict";(self.webpackChunksupport=self.webpackChunksupport||[]).push([[9482],{6122:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>s,default:()=>c,frontMatter:()=>r,metadata:()=>l,toc:()=>u});var a=n(7462),i=(n(7294),n(3905));n(5657);const r={},s="D\xe9veloppement",l={unversionedId:"standards/developpement",id:"standards/developpement",title:"D\xe9veloppement",description:"L'utilisation de services SAAS tiers doit obligatoirement \xeatre soumise \xe0 l'\xe9quipe #Legal de la fabrique.",source:"@site/docs/standards/developpement.md",sourceDirName:"standards",slug:"/standards/developpement",permalink:"/support/docs/standards/developpement",draft:!1,editUrl:"https://github.com/socialgouv/support/tree/master/docs/standards/developpement.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Accueil des produits",permalink:"/support/docs/init/accueil-produits"},next:{title:"Bases de donn\xe9es",permalink:"/support/docs/standards/databases"}},o={},u=[{value:"Conventions de la fabrique",id:"conventions-de-la-fabrique",level:2},{value:"Git workflow : <strong>trunk-based</strong>",id:"git-workflow--trunk-based",level:3},{value:"Urls des environnements",id:"urls-des-environnements",level:3},{value:"Accessibilit\xe9 (A11Y)",id:"accessibilit\xe9-a11y",level:2},{value:"Services \xe0 disposition",id:"services-\xe0-disposition",level:2},{value:"Contributions externes",id:"contributions-externes",level:2},{value:"Donn\xe9es",id:"donn\xe9es",level:3},{value:"Authentification",id:"authentification",level:3},{value:"Secrets",id:"secrets",level:3},{value:".env.sample",id:"envsample",level:4},{value:"Serveurs de d\xe9veloppement",id:"serveurs-de-d\xe9veloppement",level:3},{value:"Documentation",id:"documentation",level:3}],p={toc:u},d="wrapper";function c(e){let{components:t,...r}=e;return(0,i.kt)(d,(0,a.Z)({},p,r,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"d\xe9veloppement"},"D\xe9veloppement"),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"L'utilisation de services SAAS tiers doit obligatoirement \xeatre soumise \xe0 l'\xe9quipe #Legal de la fabrique.")),(0,i.kt)("h2",{id:"conventions-de-la-fabrique"},"Conventions de la fabrique"),(0,i.kt)("p",null,"GitHub est utilis\xe9 pour tous nos projets publics et exceptionnellement notre GitLab interne pour les projets plus sensibles."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Utiliser la ",(0,i.kt)("a",{parentName:"li",href:"https://www.numerique.gouv.fr/publications/politique-logiciel-libre/pratique/#aide-au-choix-de-la-licence"},"licence Apache-2.0")," pour les codes sources"),(0,i.kt)("li",{parentName:"ul"},"Standardiser le code avec les ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/SocialGouv/linters"},"linters SocialGouv")," ou ceux de r\xe9f\xe9rence dans la communaut\xe9."),(0,i.kt)("li",{parentName:"ul"},"Maintenir son projet \xe0 jour avec notre config renovate : ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/SocialGouv/renovate-config"},"https://github.com/SocialGouv/renovate-config")," cf ",(0,i.kt)("a",{parentName:"li",href:"/docs/faq#utilisation-de-renovate"},"la FAQ")),(0,i.kt)("li",{parentName:"ul"},"Conventionner les commits GIT : ",(0,i.kt)("a",{parentName:"li",href:"https://conventionalcommits.org/"},"https://conventionalcommits.org/")),(0,i.kt)("li",{parentName:"ul"},"Conventionner le versionning : ",(0,i.kt)("a",{parentName:"li",href:"https://semver.org"},"https://semver.org")),(0,i.kt)("li",{parentName:"ul"},"Conventionner les commentaires : ",(0,i.kt)("a",{parentName:"li",href:"https://conventionalcomments.org/"},"https://conventionalcomments.org/")),(0,i.kt)("li",{parentName:"ul"},"Releaser sur GitHub/npm : avec ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/semantic-release/semantic-release"},"semantic-release")," cf ",(0,i.kt)("a",{parentName:"li",href:"/docs/faq#semantic-release"},"la FAQ")),(0,i.kt)("li",{parentName:"ul"},"R\xe9cup\xe9rer les erreurs applicatives dans ",(0,i.kt)("a",{parentName:"li",href:"https://sentry.fabrique.social.gouv.fr"},"sentry")),(0,i.kt)("li",{parentName:"ul"},"Utiliser ",(0,i.kt)("a",{parentName:"li",href:"https://dashlord.fabrique.social.gouv.fr"},"DashLord")," pour monitorer les bonnes pratiques."),(0,i.kt)("li",{parentName:"ul"},"Le ",(0,i.kt)("a",{parentName:"li",href:"https://gouvfr.atlassian.net/wiki/spaces/DB/overview?homepageId=145359476"},"syst\xe8me de design de l'\xe9tat")," doit \xeatre utilis\xe9 par d\xe9faut. une impl\xe9mentation React existe ici : ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/dataesr/react-dsfr"},"https://github.com/dataesr/react-dsfr"))),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"\ud83d\udc49 \ud83d\udc49 \ud83d\udc49 Le repository ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/socialgouv/template"},"template")," int\xe8gre toutes ces conventions par d\xe9faut.")),(0,i.kt)("h3",{id:"git-workflow--trunk-based"},"Git workflow : ",(0,i.kt)("strong",{parentName:"h3"},"trunk-based")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"La branche par d\xe9faut est ",(0,i.kt)("inlineCode",{parentName:"li"},"master")," (ou ",(0,i.kt)("inlineCode",{parentName:"li"},"main"),")."),(0,i.kt)("li",{parentName:"ul"},"Chaque ",(0,i.kt)("inlineCode",{parentName:"li"},"pull-request")," permet de d\xe9ployer un environnement de review."),(0,i.kt)("li",{parentName:"ul"},"Chaque merge sur ",(0,i.kt)("inlineCode",{parentName:"li"},"master")," d\xe9clenche une release qui peut \xeatre pouss\xe9e en pr\xe9production puis production.")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://excalidraw.com/#json=C7MTFWdQ53ao453K86doB,SgdphjWpmSiuDMBu-qwKVg"},(0,i.kt)("img",{src:n(3476).Z,title:":size=1000x350",width:"2573",height:"750"}))),(0,i.kt)("p",null,"Ce GIT Flow est impl\xe9ment\xe9 dans les ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/SocialGouv/actions"},"GitHub actions @SocialGouv"),", l'\xe9quipe SRE vous aidera \xe0 les mettre en place."),(0,i.kt)("p",null,"\u26a0\ufe0f La release est conditionn\xe9e par la pr\xe9sence d'un commit conventionnel de type ",(0,i.kt)("inlineCode",{parentName:"p"},"fix: some fix")," ou ",(0,i.kt)("inlineCode",{parentName:"p"},"feat: some new feature"),". (cf ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/semantic-release/semantic-release#commit-message-format"},"semantic-relase default commit conventions"),")"),(0,i.kt)("h3",{id:"urls-des-environnements"},"Urls des environnements"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Url"),(0,i.kt)("th",{parentName:"tr",align:null},"Usage"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"[PRODUIT]","-feature-x.dev.fabrique.social.gouv.fr"),(0,i.kt)("td",{parentName:"tr",align:null},"feature branches")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"[PRODUIT]","-preprod.dev.fabrique.social.gouv.fr"),(0,i.kt)("td",{parentName:"tr",align:null},"preproduction")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"[PRODUIT]",".fabrique.social.gouv.fr"),(0,i.kt)("td",{parentName:"tr",align:null},"production")))),(0,i.kt)("h2",{id:"accessibilit\xe9-a11y"},"Accessibilit\xe9 (A11Y)"),(0,i.kt)("p",null,"L'accessibilit\xe9 des applications mobiles et web doit \xeatre int\xe9gr\xe9e d\xe8s le d\xe9marrage des projets. L'objectif est d'atteindre minimum 75% de conformit\xe9 au RGAA."),(0,i.kt)("p",null,"La DINUM propose l'outil ARA pour d\xe9marrer son audit d'accessibilit\xe9 : ",(0,i.kt)("a",{parentName:"p",href:"https://ara.numerique.gouv.fr/"},"https://ara.numerique.gouv.fr/")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://design.numerique.gouv.fr/en/outils/audit-complementaire/"},"r\xe9f\xe9rentiel RGAA")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://design.numerique.gouv.fr/articles/2021-10-06-assistant-rgaa/"},"Extension browser assistant RGAA"))),(0,i.kt)("h2",{id:"services-\xe0-disposition"},"Services \xe0 disposition"),(0,i.kt)("p",null,"Plusieurs services sont disponibles, ",(0,i.kt)("a",{parentName:"p",href:"/docs/infrastructure/presentation#services-transverses"},"cf infrastucture")),(0,i.kt)("p",null,"L'acc\xe8s \xe0 ces services est \xe0 demander au besoin \xe0 l'\xe9quipe SRE."),(0,i.kt)("h2",{id:"contributions-externes"},"Contributions externes"),(0,i.kt)("p",null,"La Fabrique a plusieurs int\xe9r\xeats \xe0 ce que les projets soient non seulement ",(0,i.kt)("em",{parentName:"p"},"open source")," mais \xe9galement ouverts aux contributions ext\xe9rieures :"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"recevoir l'aide volontaire de personnes hors de l'organisation"),(0,i.kt)("li",{parentName:"ul"},"simplifier l'accueil d'un nouveau membre dans l'\xe9quipe de d\xe9veloppement"),(0,i.kt)("li",{parentName:"ul"},"pouvoir demander des contributions comme exercice de recrutement"),(0,i.kt)("li",{parentName:"ul"},"encourager la maintenabilit\xe9 du code")),(0,i.kt)("p",null,"La contrainte principale \xe0 satisfaire est que n'importe qui puisse mettre en place facilement un environnement fonctionnel de d\xe9veloppement et de test en ayant acc\xe8s seulement au d\xe9p\xf4t public."),(0,i.kt)("h3",{id:"donn\xe9es"},"Donn\xe9es"),(0,i.kt)("p",null,"Si l'application a besoin de donn\xe9es pour fonctionner, cr\xe9er des \xe9chantillons et les laisser \xe0 disposition sur le d\xe9p\xf4t du projet. L'\xe9chantillon doit pouvoir \xeatre ins\xe9r\xe9 dans la base de donn\xe9es simplement."),(0,i.kt)("p",null,"Les donn\xe9es peuvent \xeatre priv\xe9es ou confidentielles. Dans ce cas, il est \xe9videmment important de transformer l'\xe9chantillon pour qu'il ne contienne pas de donn\xe9e sensible."),(0,i.kt)("p",null,"Voir par exemple ",(0,i.kt)("a",{parentName:"p",href:"https://hasura.io/docs/latest/graphql/core/hasura-cli/hasura_seed/"},"https://hasura.io/docs/latest/graphql/core/hasura-cli/hasura_seed/"),"."),(0,i.kt)("h3",{id:"authentification"},"Authentification"),(0,i.kt)("p",null,"S'il existe un syst\xe8me d'authentification qui emp\xeache un contributeur externe d'utiliser normalement le produit, alors l'environnement local de d\xe9veloppement doit permettre de contourner ce syst\xe8me d'authentification."),(0,i.kt)("p",null,"Par exemple, si l'authentification se fait avec un OAuth Github qui v\xe9rifie que la personne est membre de l'organisation Github SocialGouv, alors un d\xe9veloppeur externe sera bloqu\xe9 et ne pourra pas tester l'application. La version locale de l'application doit donc remplacer ou modifier cet OAuth afin de permettre au d\xe9veloppeur de travailler."),(0,i.kt)("p",null,"Si l'authentification est interne, fournir dans les seeds des utilisateurs de test et les documenter."),(0,i.kt)("h3",{id:"secrets"},"Secrets"),(0,i.kt)("p",null,"L'application peut avoir besoin des secrets (notamment issus de fichier ",(0,i.kt)("inlineCode",{parentName:"p"},".env"),") pour fonctionner. On peut distinguer deux types de secrets :"),(0,i.kt)("p",null,"Le premier est un secret c\xf4t\xe9 c\xf4t\xe9 serveur (par exemple une cl\xe9 priv\xe9e servant \xe0 signer un JWT), dans ce cas,  il faut s'assurer de fournir une valeur sp\xe9cifique \xe0 l'environnement de d\xe9veloppement local et prendre garde \xe0 ne pas laisser la m\xeame qu'en production, preproduction ou review."),(0,i.kt)("p",null,"Le second est une donn\xe9e connue par le serveur et qui ne peut pas \xeatre transmise aux d\xe9veloppeurs externes (par exemple un token d'acc\xe8s \xe0 un service tiers, une API d'envoi de mail, etc.). Dans ce cas, il faut s'assurer que le produit puisse fonctionner en local en mode d\xe9grad\xe9 m\xeame sans cette valeur. Par exemple, si on ne peut pas donner un certain token permettant de t\xe9l\xe9charger des donn\xe9es mais que l'on fournit \xe0 la place un \xe9chantillon de ces donn\xe9es au d\xe9veloppeur, une fonctionnalit\xe9 a \xe9t\xe9 exclue mais le produit reste fonctionnel."),(0,i.kt)("h4",{id:"envsample"},".env.sample"),(0,i.kt)("p",null,"Une fois la liste des secrets \xe0 fournir en environnement de d\xe9veloppement clairement \xe9tablie, une des mani\xe8res de les fournir sur le d\xe9p\xf4t est des cr\xe9er une fichier ",(0,i.kt)("inlineCode",{parentName:"p"},".env.sample")," que le d\xe9veloppeur pourra copier vers ",(0,i.kt)("inlineCode",{parentName:"p"},".env")," apr\xe8s avoir clon\xe9 le d\xe9p\xf4t."),(0,i.kt)("h3",{id:"serveurs-de-d\xe9veloppement"},"Serveurs de d\xe9veloppement"),(0,i.kt)("p",null,"La mise en place des serveurs de d\xe9veloppement doit aussi \xeatre accessible. Le plus souvent, on pourra utiliser ",(0,i.kt)("inlineCode",{parentName:"p"},"docker-compose")," pour assembler les composants de backend et les bases de donn\xe9es. Parall\xe8lement, on pourra utiliser les serveurs de d\xe9veloppement fournis avec les frameworks (React, Next.js) pour le frontend."),(0,i.kt)("h3",{id:"documentation"},"Documentation"),(0,i.kt)("p",null,"Une fois qu'un environnement de d\xe9veloppement viable et accessible a \xe9t\xe9 con\xe7u, il est primordial de bien documenter comment un d\xe9veloppeur peut le mettre en place facilement. Cela peut par exemple prendre la forme d'une section dans le README du projet qui d\xe9crit la mise place en pr\xe9cisant clairement les pr\xe9requis et l'ordre des \xe9tapes."),(0,i.kt)("p",null,"En plus de la mise en place de l'environnement de d\xe9veloppement, il est important de documenter le fonctionnement du produit, ses diff\xe9rents composants ainsi que leurs APIs afin de faciliter la prise en main de nouveaux d\xe9veloppeurs."))}c.isMDXComponent=!0},3476:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/git-flow-simple-53504d4107acc6b645853571368fbc84.png"}}]);