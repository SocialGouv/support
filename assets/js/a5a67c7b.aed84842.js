"use strict";(self.webpackChunksupport=self.webpackChunksupport||[]).push([[771],{1243:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>o,contentTitle:()=>r,default:()=>d,frontMatter:()=>n,metadata:()=>l,toc:()=>u});var a=s(7462),i=(s(7294),s(3905));s(828);const n={},r="S\xe9curit\xe9",l={unversionedId:"standards/securite",id:"standards/securite",title:"S\xe9curit\xe9",description:"Tous les acc\xe8s aux outils doivent \xeatre s\xe9curis\xe9s par authentification double-facteurs (2FA)",source:"@site/docs/standards/securite.md",sourceDirName:"standards",slug:"/standards/securite",permalink:"/support/docs/standards/securite",draft:!1,editUrl:"https://github.com/socialgouv/support/tree/master/docs/standards/securite.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Bases de donn\xe9es",permalink:"/support/docs/standards/databases"},next:{title:"Kubernetes (K8S)",permalink:"/support/docs/standards/kubernetes"}},o={},u=[{value:"Outils",id:"outils",level:2},{value:"DashLord : dashboard de s\xe9curit\xe9 et accessibilt\xe9",id:"dashlord--dashboard-de-s\xe9curit\xe9-et-accessibilt\xe9",level:3},{value:"SonarCloud : analyseur statique de code",id:"sonarcloud--analyseur-statique-de-code",level:3},{value:"Talisman : pr\xe9vention de publication de secrets",id:"talisman--pr\xe9vention-de-publication-de-secrets",level:3},{value:"Best practices",id:"best-practices",level:2},{value:"CODEOWNERS",id:"codeowners",level:3},{value:"Third-parties",id:"third-parties",level:3},{value:"Maintenance des d\xe9pendances",id:"maintenance-des-d\xe9pendances",level:3},{value:"Contr\xf4les d&#39;acc\xe8s",id:"contr\xf4les-dacc\xe8s",level:3},{value:"Leak d&#39;informations",id:"leak-dinformations",level:3},{value:"S\xe9curit\xe9 navigateurs",id:"s\xe9curit\xe9-navigateurs",level:3},{value:"Sessions",id:"sessions",level:3},{value:"Mots de passe",id:"mots-de-passe",level:3},{value:"Robustesse",id:"robustesse",level:4},{value:"Proc\xe9dure de changement de mot de passe",id:"proc\xe9dure-de-changement-de-mot-de-passe",level:4},{value:"Proc\xe9dure de reset de mot passe",id:"proc\xe9dure-de-reset-de-mot-passe",level:4},{value:"DDOS",id:"ddos",level:3},{value:"Logging",id:"logging",level:3},{value:"Upload de fichiers",id:"upload-de-fichiers",level:3},{value:"Risques",id:"risques",level:4},{value:"Mesures",id:"mesures",level:4},{value:"FAQ",id:"faq",level:2},{value:"Mettre \xe0 jour les headers HTTP de mes applications",id:"mettre-\xe0-jour-les-headers-http-de-mes-applications",level:3},{value:"Directement via l&#39;Ingress",id:"directement-via-lingress",level:4},{value:"C\xf4t\xe9 applicatif",id:"c\xf4t\xe9-applicatif",level:4},{value:"Chiffrer des fichiers",id:"chiffrer-des-fichiers",level:3},{value:"R\xe9f\xe9rences",id:"r\xe9f\xe9rences",level:2},{value:"G\xe9n\xe9ral",id:"g\xe9n\xe9ral",level:3},{value:"NodeJS",id:"nodejs",level:3},{value:"Docker",id:"docker",level:3}],p={toc:u};function d(e){let{components:t,...s}=e;return(0,i.kt)("wrapper",(0,a.Z)({},p,s,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"s\xe9curit\xe9"},"S\xe9curit\xe9"),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Tous les acc\xe8s aux outils doivent \xeatre s\xe9curis\xe9s par authentification double-facteurs (2FA)")),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Les variables d'environnement doivent \xeatre utilis\xe9es pour tout ce qui est secrets, tokens, logins, urls, hostnames...")),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"La gestion des secrets est assur\xe9e par des ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/bitnami-labs/sealed-secrets"},"sealed-secrets")," qui versionne les secrets chiffr\xe9s dans GIT.")),(0,i.kt)("h2",{id:"outils"},"Outils"),(0,i.kt)("h3",{id:"dashlord--dashboard-de-s\xe9curit\xe9-et-accessibilt\xe9"},"DashLord : dashboard de s\xe9curit\xe9 et accessibilt\xe9"),(0,i.kt)("p",null,"Accessible ici (se connecter pour voir plus d'informations) : ",(0,i.kt)("a",{parentName:"p",href:"https://dashlord.fabrique.social.gouv.fr"},"https://dashlord.fabrique.social.gouv.fr"),"."),(0,i.kt)("p",null,"Voir aussi : ",(0,i.kt)("a",{parentName:"p",href:"https://doc.incubateur.net/communaute/travailler-a-beta-gouv/jutilise-les-outils-de-la-communaute/dashlord"},"https://doc.incubateur.net/communaute/travailler-a-beta-gouv/jutilise-les-outils-de-la-communaute/dashlord"),"."),(0,i.kt)("h3",{id:"sonarcloud--analyseur-statique-de-code"},"SonarCloud : analyseur statique de code"),(0,i.kt)("p",null,"Les produits de l'organisation sont tous scann\xe9s et les r\xe9sultats sont accessibles ici : ",(0,i.kt)("a",{parentName:"p",href:"https://sonarcloud.io/organizations/socialgouv"},"https://sonarcloud.io/organizations/socialgouv"),"."),(0,i.kt)("h3",{id:"talisman--pr\xe9vention-de-publication-de-secrets"},"Talisman : pr\xe9vention de publication de secrets"),(0,i.kt)("p",null,"Publier involontairement un secret (par exemple un jeton d'acc\xe8s) sur un d\xe9p\xf4t public peut avoir beaucoup de cons\xe9quences ind\xe9sirables. Une mani\xe8re efficace d'\xe9viter cela est d'ex\xe9cuter ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/thoughtworks/talisman/"},"un d\xe9tecteur de secrets comme ",(0,i.kt)("inlineCode",{parentName:"a"},"talisman"))," sur le hook ",(0,i.kt)("inlineCode",{parentName:"p"},"pre-commit")," de git."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'yarn add -D husky is-ci node-talisman\n\n# husky se met en place sur toute ex\xe9cution de "yarn install"\nnpm set-script postinstall "is-ci || husky install"\n\n# installation de husky\nyarn\n\n# ex\xe9cuter node-talisman sur le hook de pre-commit\nyarn husky add .husky/pre-commit "exec < /dev/tty; yarn node-talisman --githook pre-commit -i"\n\n# configure le repo en JS\necho "scopeconfig:\\n  - scope: node" > .talismanrc\n\n')),(0,i.kt)("p",null,"On utilise ",(0,i.kt)("inlineCode",{parentName:"p"},"husky")," pour g\xe9rer simplement le hook. Si vous utilisez d\xe9j\xe0 un gestionnaire de hooks, il suffit d'installer ",(0,i.kt)("inlineCode",{parentName:"p"},"node-talisman")," et d'ajouter en pre-commit ",(0,i.kt)("inlineCode",{parentName:"p"},"yarn node-talisman --githook pre-commit -i"),"."),(0,i.kt)("p",null,"On pourra observer des cas de faux positif de talisman, par exemple sur le fichier ",(0,i.kt)("inlineCode",{parentName:"p"},"yarn.lock")," ou des donn\xe9es base64. Dans ce cas, on lit attentivement le rapport, et on ajuste ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/thoughtworks/talisman/#ignoring-files"},"le fichier ",(0,i.kt)("inlineCode",{parentName:"a"},".talismanrc"))," en fonction."),(0,i.kt)("h2",{id:"best-practices"},"Best practices"),(0,i.kt)("p",null,"Les ",(0,i.kt)("a",{parentName:"p",href:"https://cheatsheetseries.owasp.org/"},"cheat sheets OWASP")," sont une tr\xe8s bonne r\xe9f\xe9rence."),(0,i.kt)("h3",{id:"codeowners"},"CODEOWNERS"),(0,i.kt)("p",null,"Les workflows d'int\xe9gration et d\xe9ploiements continus des repositories SocialGouv sont prot\xe9g\xe9s par la convention ",(0,i.kt)("a",{parentName:"p",href:"https://github.blog/2017-07-06-introducing-code-owners/"},"CODEOWNERS")," : tout changement impactant potentiellement l'infrastructure doit \xeatre revue par une personne de l'\xe9quipe OPS ou SRE. Ils seront automatiquement assign\xe9s aux issues qui touchent aux fichiers de CI lors d'une pull-request."),(0,i.kt)("h3",{id:"third-parties"},"Third-parties"),(0,i.kt)("p",null,"De mani\xe8re g\xe9n\xe9rale il est d\xe9conseill\xe9 de r\xe9f\xe9rencer des scripts externes dans ses applications, comme des scripts ou CSS via CDN, google fonts ou autres services tiers; Privil\xe9gier l'utilisation de librairies d\xe9di\xe9es que vous pouvez embarquer dans l'application elle-m\xeame."),(0,i.kt)("h3",{id:"maintenance-des-d\xe9pendances"},"Maintenance des d\xe9pendances"),(0,i.kt)("p",null,"Les packages utilis\xe9s dans les applications doivent \xeatre maintenus \xe0 jour et scann\xe9s r\xe9guli\xe8rement, id\xe9alement dans la CI."),(0,i.kt)("p",null,"Les packages non utilis\xe9s ou obsol\xe8tes doivent \xeatre supprim\xe9s."),(0,i.kt)("p",null,"Utilisez ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/SocialGouv/renovate-config"},"renovate")," pour maintenir votre application \xe0 jour et pr\xe9voyez le temps n\xe9cessaire dans les sprints."),(0,i.kt)("h3",{id:"contr\xf4les-dacc\xe8s"},"Contr\xf4les d'acc\xe8s"),(0,i.kt)("p",null,"La mise en place d'un middleware de RBAC par lequel toutes les requ\xeates entrantes passent permet de rejeter au plus t\xf4t les requ\xeates ill\xe9gitimes et de mettre en place une liste blanche de pages ou endpoints non prot\xe9g\xe9s (le comportement par d\xe9faut \xe9tant \"prot\xe9g\xe9\" pour \xe9viter l'introduction de d\xe9fauts de contr\xf4le d'acc\xe8s au fur et \xe0 mesure des d\xe9veloppements)."),(0,i.kt)("p",null,"Ex : ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/nyambati/express-acl"},"https://github.com/nyambati/express-acl")),(0,i.kt)("p",null,"Mettre en place une ",(0,i.kt)("strong",{parentName:"p"},"matrice des r\xf4les")," qui associe \xe0 chaque type de donn\xe9e des permissions de type lecture/\xe9criture par r\xf4le."),(0,i.kt)("h3",{id:"leak-dinformations"},"Leak d'informations"),(0,i.kt)("p",null,"Les informations techniques ne doivent pas \xeatre expos\xe9es au runtime. Les serveurs et applications ne doivent pas fournir de header ou signature permettant de les identifier. (ex: header ",(0,i.kt)("inlineCode",{parentName:"p"},"Served-by"),")"),(0,i.kt)("p",null,"Les donn\xe9es de d\xe9veloppement (GIT et bases de donn\xe9es) doivent \xeatre consid\xe9r\xe9es comme publiques et ne pas utiliser de donn\xe9es sensibles ou personnelles."),(0,i.kt)("p",null,"Les d\xe9veloppeur(se)s ne doivent en aucun cas recevoir de donn\xe9es de production sur leur poste de travail. Les \xe9quipes de dev doivent mettre en oeuvre des m\xe9canismes de ",(0,i.kt)("inlineCode",{parentName:"p"},"seeds")," pour travailler avec des volumes de donn\xe9es r\xe9alistes."),(0,i.kt)("p",null,"Les applications ne doivent jamais logger d'information confidentielle ou de credentials sur la console. En effet ces informations pourraient remonter sur les outils de logging tels Sentry ou grafana."),(0,i.kt)("h3",{id:"s\xe9curit\xe9-navigateurs"},"S\xe9curit\xe9 navigateurs"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"D\xe9finir une ",(0,i.kt)("strong",{parentName:"li"},"content security policy (CSP) stricte"),", comme par exemple : en-t\xeate HTTP Content-Security-Policy: default-src 'self'; frame-ancestors 'self'; Utiliser un outil comme ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/april/laboratory"},"Laboratory")," pour profiler votre application et v\xe9rifier les headers CSP."),(0,i.kt)("li",{parentName:"ul"},"D\xe9finir l'attribut \"integrity\" sur l'ensemble des ressources link et script de la page (",(0,i.kt)("strong",{parentName:"li"},"SubResource Integrity"),")."),(0,i.kt)("li",{parentName:"ul"},"Gestion des ",(0,i.kt)("strong",{parentName:"li"},"cookies")," : utiliser les attributs de cookie ",(0,i.kt)("strong",{parentName:"li"},"HttpOnly, Secure et SameSite"),'. Ne pas mettre SameSite \xe0 "None".'),(0,i.kt)("li",{parentName:"ul"},"Auto-h\xe9berger l'ensemble des ressources de la page. Pour celles qui ne peuvent pas l'\xeatre et pour les traitements de moindre confiance, utiliser un WebWorker ou une iFrame avec l'attribut \"sandbox\"."),(0,i.kt)("li",{parentName:"ul"},"Les verbes HTTP doivent \xeatre respect\xe9s, les op\xe9rations ",(0,i.kt)("inlineCode",{parentName:"li"},"GET")," ne doivent pas modifier de donn\xe9es."),(0,i.kt)("li",{parentName:"ul"},"En cas d'utilisation de sessions, les op\xe9rations qui impactent des donn\xe9es doivent \xeatre prot\xe9g\xe9es des ",(0,i.kt)("a",{parentName:"li",href:"https://www.cert.ssi.gouv.fr/information/CERTA-2008-INF-003/"},"attaques de type CSRF")," avec un syst\xe8me de jeton.")),(0,i.kt)("p",null,"Ex: ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/helmetjs/helmet"},"https://github.com/helmetjs/helmet")),(0,i.kt)("h3",{id:"sessions"},"Sessions"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Les sessions des utilisateurs authentifi\xe9s doivent expirer automatiquement et pouvoir \xeatre ferm\xe9es par l'utilisateur (cette action doit effectivement supprimer la session c\xf4te serveur)."),(0,i.kt)("li",{parentName:"ul"},"Les sessions doivent pouvoir \xeatre ferm\xe9es par des administrateurs"),(0,i.kt)("li",{parentName:"ul"},"Dur\xe9e : Le d\xe9lai doit \xeatre adapt\xe9 \xe0 la dur\xe9e d'utilisation l\xe9gitime pr\xe9vue (pour les utilisateurs authentifi\xe9s) et \xe0 la sensibilit\xe9 des donn\xe9es. Ex: 6h pour une s\xe9curit\xe9 moyenne")),(0,i.kt)("h3",{id:"mots-de-passe"},"Mots de passe"),(0,i.kt)("h4",{id:"robustesse"},"Robustesse"),(0,i.kt)("p",null,"Les empreintes de mot de passe doivent \xeatre stock\xe9es de fa\xe7on s\xe9curis\xe9e, en s'en remettant \xe0 une impl\xe9mentation propos\xe9e par le framework ou langage utilis\xe9, apr\xe8s avoir v\xe9rifi\xe9 qu'il impl\xe9mente correctement une fonction ad\xe9quate pour le stockage des empreintes, telle que PBKDF2, Bcrypt, Scrypt ou Argon2, avec des contraintes temps/m\xe9moire adapt\xe9es."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Forcer la complexit\xe9 du mot de passe")," \xe0 : minimum 12 chars, 1 majuscule, 1 minuscule, 1 chiffre, 1 caract\xe8re sp\xe9cial"),(0,i.kt)("p",null,"Proposer \xe0 l'utilisateur de lui g\xe9n\xe9rer."),(0,i.kt)("h4",{id:"proc\xe9dure-de-changement-de-mot-de-passe"},"Proc\xe9dure de changement de mot de passe"),(0,i.kt)("p",null,"Avertir par email l'utilisateur en cas de changement de mot passe."),(0,i.kt)("h4",{id:"proc\xe9dure-de-reset-de-mot-passe"},"Proc\xe9dure de reset de mot passe"),(0,i.kt)("p",null,"Voir r\xe9f\xe9rences ",(0,i.kt)("a",{parentName:"p",href:"https://cheatsheetseries.owasp.org/cheatsheets/Forgot_Password_Cheat_Sheet.html"},"OWASP")," et ",(0,i.kt)("a",{parentName:"p",href:"https://www.troyhunt.com/everything-you-ever-wanted-to-know/"},"building a secure password reset feature")),(0,i.kt)("p",null,"Avertir par email l'utilisateur en cas de changement de mot passe."),(0,i.kt)("p",null,"Voir aussi cet article sur les ",(0,i.kt)("a",{parentName:"p",href:"https://hiddedevries.nl/en/blog/2018-01-13-making-password-managers-play-ball-with-your-login-form"},"forms de logins et passwords managers")),(0,i.kt)("h3",{id:"ddos"},"DDOS"),(0,i.kt)("p",null,"Les mesures de pr\xe9vention anti-DDOS et Waf doivent \xeatre mis en place en amont de l'application (c\xf4t\xe9 infra/reverse-proxy)"),(0,i.kt)("p",null,"C\xf4t\xe9 applicatif, l'utilisation de fonctions synchrones trop gourmandes en CPU (exemples : ",(0,i.kt)("inlineCode",{parentName:"p"},"readFileSync"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"jwt.verify")," sans callback, ",(0,i.kt)("inlineCode",{parentName:"p"},"bcrypt.hashSync"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"bcrypt.genSaltSync"),") pr\xe9sente deux types de risques :"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"c\xf4t\xe9 serveur")," : vuln\xe9rabilit\xe9 augment\xe9e au d\xe9ni de service (DOS), l'attaquant pouvant cibler les pages qui mettent en oeuvre ce type de fonctions c\xf4t\xe9 serveur pour diminuer le co\xfbt de l'attaque.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"c\xf4t\xe9 client"),' : le blocage du fil d\'ex\xe9cution principal se traduit en un "freeze" d\xe9sagr\xe9able de la page'))),(0,i.kt)("p",null,"Il est recommand\xe9 de faire appel \xe0 la version asynchrone de ces fonctions, ou de les wrapper dans un thread ou web worker si elles n'ont pas d'impl\xe9mentation asynchrone disponible."),(0,i.kt)("h3",{id:"logging"},"Logging"),(0,i.kt)("p",null,"Journaliser explicitement les erreurs issues de la logique de l'application, qui sont inconnues du runtime. par exemple \xe0 l'aide de sentry. La remont\xe9e d'exceptions dans sentry doit veiller \xe0 ne pas remonter de donn\xe9es sensibles (ex: cookies)."),(0,i.kt)("p",null,"L'application doit logger en JSON (cf ",(0,i.kt)("a",{parentName:"p",href:"/support/docs/standards/kubernetes"},"12 factors apps"),")"),(0,i.kt)("p",null,"C\xf4t\xe9 base de donn\xe9es, un audit log peut \xeatre n\xe9cessaire. Ex: ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/hasura/audit-trigger"},"https://github.com/hasura/audit-trigger")),(0,i.kt)("h3",{id:"upload-de-fichiers"},"Upload de fichiers"),(0,i.kt)("h4",{id:"risques"},"Risques"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"perte d'int\xe9grit\xe9 comportement/contenu")," : remplacement de code applicatif au moyen d'un fichier upload\xe9 / h\xe9bergement de contenu illicite (ex\xe9cution non ma\xeetris\xe9e ou m\xe9sinterpr\xe9tation du contenu)"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"perte de confidentialit\xe9")," : fuite de documents (d\xe9faut de contr\xf4le d'acc\xe8s)"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"perte de disponibilit\xe9")," : d\xe9ni de service de l'application (d\xe9faut de limitation en ressources)")),(0,i.kt)("h4",{id:"mesures"},"Mesures"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Upload")," :",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Limiter la taille du fichier"),(0,i.kt)("li",{parentName:"ul"},"V\xe9rifier type mime envoy\xe9 par le client et le comparer \xe0 une liste blanche pr\xe9-\xe9tablie, le stocker, puis refl\xe9ter la m\xeame valeur lors du download du fichier par un utilisateur"),(0,i.kt)("li",{parentName:"ul"},"Si un traitement doit \xeatre r\xe9alis\xe9, le d\xe9porter sur un webservice d\xe9di\xe9"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Stockage")," :",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Stocker les fichiers dans un emplacement impos\xe9, hors du document root, dans une partition d\xe9di\xe9e, ou en base de donn\xe9es"),(0,i.kt)("li",{parentName:"ul"},"Ne pas utiliser le nom fourni dans les en-t\xeates HTTP pour le stockage direct du fichier (exemple : utiliser un ",(0,i.kt)("inlineCode",{parentName:"li"},"sha-256")," sal\xe9 sur le nom ou encore un jeton d'acc\xe8s al\xe9atoire avec lequel la correspondance sera faite en base - ne pas conserver l'extension)"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Download")," :",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Utilisation un contr\xf4leur qui induit un niveau d'abstraction entre la fa\xe7on de r\xe9cup\xe9rer le fichier et la situation r\xe9elle c\xf4t\xe9 serveur. (exemple : GET ",(0,i.kt)("inlineCode",{parentName:"li"},"/download?[random_token]")," VS GET ",(0,i.kt)("inlineCode",{parentName:"li"},"/static/mnt/volume/fichier.pdf"),")"),(0,i.kt)("li",{parentName:"ul"},"Utiliser l'en-t\xeate ",(0,i.kt)("inlineCode",{parentName:"li"},"Content-Disposition: attachement")," afin de forcer le t\xe9l\xe9chargement"),(0,i.kt)("li",{parentName:"ul"},"Utiliser l'en-t\xeate ",(0,i.kt)("inlineCode",{parentName:"li"},"Content-Type")," avec la valeur \xe9mise lors de l'upload"),(0,i.kt)("li",{parentName:"ul"},"Utiliser l'en-t\xeate ",(0,i.kt)("inlineCode",{parentName:"li"},"X-Content-Type-Options: nosniff")," afin d'emp\xeacher le navigateur d'inf\xe9rer le type du fichier et de lui demander de respecter le Content-Type que l'on aura positionn\xe9.")))),(0,i.kt)("h2",{id:"faq"},"FAQ"),(0,i.kt)("h3",{id:"mettre-\xe0-jour-les-headers-http-de-mes-applications"},"Mettre \xe0 jour les headers HTTP de mes applications"),(0,i.kt)("p",null,"Inspectez les headers HTTP de votre frontend avec ",(0,i.kt)("a",{parentName:"p",href:"https://observatory.mozilla.org/"},"Mozilla HTTP Observatory"),". Vous pouvez \xe9galement les retrouver sur ",(0,i.kt)("a",{parentName:"p",href:"https://dashlord-full.fabrique.social.gouv.fr/"},"DashLord"),"."),(0,i.kt)("p",null,"Plusieurs possibilit\xe9s pour corriger vos headers :"),(0,i.kt)("h4",{id:"directement-via-lingress"},"Directement via l'Ingress"),(0,i.kt)("p",null,"Il est possible d'ajouter des annotations pour forcer les headers directement sur la route de votre application."),(0,i.kt)("p",null,"Exemple avec kontinuous ou kube-workflow, dans le ",(0,i.kt)("inlineCode",{parentName:"p"},"values.yaml")," de votre application :"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"app:\n  ingress:\n    annotations:\n      nginx.ingress.kubernetes.io/configuration-snippet: |\n        more_set_headers \"Content-Security-Policy: default-src 'none'; connect-src 'self' https://*.gouv.fr; font-src 'self'; img-src 'self'; prefetch-src 'self' https://*.gouv.fr; script-src 'self' https://*.gouv.fr; frame-src 'self' https://*.gouv.fr; style-src 'self' 'unsafe-inline'\";\n        more_set_headers \"X-Frame-Options: deny\";\n        more_set_headers \"X-XSS-Protection: 1; mode=block\";\n        more_set_headers \"X-Content-Type-Options: nosniff\";\n")),(0,i.kt)("p",null,"La CSP est \xe0 adapter selon vos scripts externes; vous pouvez la d\xe9finir manuellement ou avec l'extension ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/april/laboratory"},"CSP laboratory"),"."),(0,i.kt)("p",null,"Le repo ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/SocialGouv/template"},"template")," pr\xe9sente l'int\xe9gration dans un Next.js statique (branche ",(0,i.kt)("inlineCode",{parentName:"p"},"main"),") ou avec un serveur (branche ",(0,i.kt)("inlineCode",{parentName:"p"},"hasura"),")."),(0,i.kt)("h4",{id:"c\xf4t\xe9-applicatif"},"C\xf4t\xe9 applicatif"),(0,i.kt)("p",null,"Il est possible d'ajouter les headers c\xf4t\xe9 applicatif, par exemple avec ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/helmetjs/helmet"},"helmet"),"."),(0,i.kt)("h3",{id:"chiffrer-des-fichiers"},"Chiffrer des fichiers"),(0,i.kt)("p",null,"Si vous souhaitez chiffrer des fichiers c\xf4t\xe9 serveur, vous pouvez utiliser le module ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/SocialGouv/streaming-file-encryption"},"streaming-file-encryption"),"."),(0,i.kt)("p",null,"La s\xe9curit\xe9 de ce module repose sur la connaissance n\xe9cessaire de 3 informations disctinctes pour pouvoir d\xe9chiffrer un fichier :"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Le ",(0,i.kt)("inlineCode",{parentName:"li"},"mainSecret")," \xe0 d\xe9finir en tant que variable d'environnement c\xf4t\xe9 applicatif"),(0,i.kt)("li",{parentName:"ul"},"Le ",(0,i.kt)("inlineCode",{parentName:"li"},"context")," \xe0 stocker dans votre base de donn\xe9es et li\xe9 \xe0 votre fichier"),(0,i.kt)("li",{parentName:"ul"},"Le ",(0,i.kt)("inlineCode",{parentName:"li"},"ciphertext")," \xe0 stocker sur un volume disque persistant")),(0,i.kt)("p",null,"\u26a0\ufe0f il est essentiel de stocker ces donn\xe9es dans des espaces isol\xe9s."),(0,i.kt)("p",null,"Les fichiers chiffr\xe9s r\xe9pondent\xa0aux propri\xe9t\xe9s cryptographiques suivantes :"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"R\xe9sistance \xe0 la falsification (modification des donn\xe9es)"),(0,i.kt)("li",{parentName:"ul"},"R\xe9sistance \xe0 la troncature (suppression des donn\xe9es \xe0 chaque extr\xe9mit\xe9 ou au milieu)"),(0,i.kt)("li",{parentName:"ul"},"R\xe9sistance \xe0 l'extension (ajout de donn\xe9es \xe0 chaque extr\xe9mit\xe9 ou au milieu)"),(0,i.kt)("li",{parentName:"ul"},"R\xe9sistance \xe0 la r\xe9organisation (\xe9change de pages de donn\xe9es)")),(0,i.kt)("h2",{id:"r\xe9f\xe9rences"},"R\xe9f\xe9rences"),(0,i.kt)("h3",{id:"g\xe9n\xe9ral"},"G\xe9n\xe9ral"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://www.ssi.gouv.fr/uploads/2018/11/guide-securite-numerique-agile-anssi-pa-v1.pdf"},"guide ANSSI de la s\xe9curit\xe9 agile")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://cheatsheetseries.owasp.org/"},"https://cheatsheetseries.owasp.org/")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://www.ssi.gouv.fr/guide/mot-de-passe/"},"https://www.ssi.gouv.fr/guide/mot-de-passe/")),(0,i.kt)("li",{parentName:"ul"},"Reset password best practices : ",(0,i.kt)("a",{parentName:"li",href:"https://www.troyhunt.com/everything-you-ever-wanted-to-know/"},"https://www.troyhunt.com/everything-you-ever-wanted-to-know/"))),(0,i.kt)("h3",{id:"nodejs"},"NodeJS"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://www.sqreen.com/checklists/nodejs-security-handbook"},"https://www.sqreen.com/checklists/nodejs-security-handbook")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/goldbergyoni/nodebestpractices#6-security-best-practices"},"https://github.com/goldbergyoni/nodebestpractices#6-security-best-practices")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/nodejs/docker-node/blob/master/docs/BestPractices.md"},"https://github.com/nodejs/docker-node/blob/master/docs/BestPractices.md"))),(0,i.kt)("h3",{id:"docker"},"Docker"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://www.ssi.gouv.fr/administration/publication/recommandations-de-securite-relatives-au-deploiement-de-conteneurs-docker/"},"https://www.ssi.gouv.fr/administration/publication/recommandations-de-securite-relatives-au-deploiement-de-conteneurs-docker/")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://docs.docker.com/develop/develop-images/dockerfile_best-practices/"},"https://docs.docker.com/develop/develop-images/dockerfile_best-practices/")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://snyk.io/blog/10-docker-image-security-best-practices/"},"https://snyk.io/blog/10-docker-image-security-best-practices/")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/OWASP/Docker-Security"},"https://github.com/OWASP/Docker-Security")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/Docker_Security_Cheat_Sheet.md"},"https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/Docker_Security_Cheat_Sheet.md"))))}d.isMDXComponent=!0}}]);