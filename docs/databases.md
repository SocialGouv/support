# Bases de donn√©es

Nous utilisons principalement PostgreSQL comme moteur de BDD relationnelle.

La qualit√© du mod√®le de donn√©es est cruciale dans le d√©veloppement :

- simplification des applications qui vont exploiter ces donn√©es
- communication avec le reste de l'√©quipe (une s√©mantique commune)
- performance des requ√™tes
- int√©grit√© des donn√©es
- s√©curit√©...

Il est important de prendre le temps de concevoir un mod√®le de donn√©es coh√©rent et scalable que vous pourrez partager facilement avec les product owners (m√©tier) et faire √©voluer ensemble.

![](_media/db-model.png ":size=1000x450")

## Recommandations

- Les [ORMs](https://www.base-de-donnees.com/orm/) ne sont _pas_ recommand√©s
- Utiliser [Postgres.js](https://github.com/porsager/postgres)
- Utiliser ou outil qui g√®re les migrations (ex: )
- Cr√©er des fichiers de seed pour vos environnements de test/review
- Maintenir un diagramme du mod√®le dans le repo (par ex avec: [draw.io](https://draw.io), [DBeaver](https://dbeaver.io/download/), [pg_diagram](https://github.com/qweeze/pg_diagram))
- APIs: utiliser [hasura](https://hasura.io/) pour d√©l√©guer une grosse partie de l'API notamment l'auth

## Conventions

- [SQL Style guide](https://www.sqlstyle.guide/)
- Positionner le diagramme dans `docs/db-model.png` sur votre repo
- `yarn seed` pour executer les seeds

## Chiffrement

[todo]: cf travaux Mano/Domifa ou [exemple chiffrement ?](https://medium.com/@jianshi_94445/encrypt-decrypt-your-data-using-native-postgres-functions-with-sequelize-js-c04948d96833)

## Skill up

- üá´üá∑ üíô [Livre blanc ](https://public.dalibo.com/exports/marketing/livres_blancs/dlb04-modeliser_avec_postgresql/DLB04_Modeliser_avec_PostgreSQL.pdf) de [Dalibo](https://www.dalibo.com/) : Bonnes pratiques de mod√©lisation
- üá´üá∑ üíô [Vid√©os PostgreSQL de xavki](https://www.youtube.com/playlist?list=PLn6POgpklwWonHjoGXXSIXJWYzPSy2FeJ) : 34 vid√©os sur PostgreSQL et ses internals
- [awesome-postgres](https://github.com/dhamaniasad/awesome-postgres)

## Related

- [Visual EXPLAIN](https://explain.depesz.com/s/6Pkc)
- [PostgreSQL cheatsheet](https://quickref.me/postgres)
- [PG audit log](https://github.com/hasura/audit-trigger)
- https://prql-lang.org/
- fun: [Postgres in JS](https://oguimbal.github.io/pg-mem-playground/)
